spec:
  version: "1.0"
  schema: v92

definitions:
  baseCondition:
    awaken: false
    masterpiece: false
    params:
      evolutionProb: 1.0
      requiredMoney: 10000

evolutions:
  upsert:
    # ━━ Quest Rewards ━━
    # ── Paverune of Shara (501) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 501
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 10121, result: 12265 }  # Pathfinder Pair
          - { target: 10122, result: 12266 }  # Duty's Lance
          - { target: 10123, result: 12267 }  # Pathsweeper
          - { target: 10124, result: 12268 }  # Chopper
          - { target: 10125, result: 12269 }  # Harvest Focus
          - { target: 10126, result: 12270 }  # Arrowsvine
          - { target: 10127, result: 12271 }  # Staff of Redemption
          - { target: 10128, result: 12272 }  # Wand of the Frond
          - { target: 55020, result: 55288 }  # Nobleshot
          - { target: 58186, result: 58439 }  # Trailcover
          - { target: 59068, result: 59336 }  # Pathdancer
          - { target: 82020, result: 82288 }  # Warfists

    # ── Paverune of Arun (511) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 511
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 15138, result: 17559 }  # Hit Kickers
          - { target: 15141, result: 17562 }  # Tenebral Boots
          - { target: 15144, result: 17565 }  # Umbral Slippers
          - { target: 15136, result: 17557 }  # Nightshimmer Chestplate
          - { target: 15139, result: 17560 }  # Moonrise Vest
          - { target: 15142, result: 17563 }  # Nightswift Gown
          - { target: 15137, result: 17558 }  # Duskweaver Gauntlets
          - { target: 15140, result: 17561 }  # Nightfists
          - { target: 15143, result: 17564 }  # Somnus Sleeves

    # ━━ Bastion of Lok ━━
    # ── Silrune of Shara (502) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 502
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 12265, result: 12273 }  # Blood & Gore
          - { target: 12266, result: 12274 }  # Bloodstrike
          - { target: 12267, result: 12275 }  # Cruelblade
          - { target: 12268, result: 12276 }  # Bloodshatter
          - { target: 12269, result: 12277 }  # Heartcoil
          - { target: 12270, result: 12278 }  # Airheart
          - { target: 12271, result: 12279 }  # Tuskrender
          - { target: 12272, result: 12280 }  # Bloodhorn
          - { target: 55288, result: 55289 }  # Hemoblaster
          - { target: 58439, result: 58440 }  # Hemobloom
          - { target: 59336, result: 59337 }  # Truncuspear
          - { target: 82288, result: 82289 }  # Bloody Knuckles

    # ── Silrune of Arun (512) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 512
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17559, result: 17568 }  # Grisly Greaves
          - { target: 17562, result: 17571 }  # Vulcanite Boots
          - { target: 17565, result: 17574 }  # Cruelhide Shoes
          - { target: 17557, result: 17566 }  # Brutal Breastplate
          - { target: 17560, result: 17569 }  # Sanguine Cuirass
          - { target: 17563, result: 17572 }  # Vulcanite Raiment
          - { target: 17558, result: 17567 }  # Tuskbreaker Gauntlets
          - { target: 17561, result: 17570 }  # Gloves of the Vulcan
          - { target: 17564, result: 17573 }  # Bloodbound Sleeves

    # ━━ Sinestral Manor ━━
    # ── Silrune of Shara (502) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 502
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 12273, result: 17926 }  # Fear & Tremble
          - { target: 12274, result: 17927 }  # Dreadspike
          - { target: 12275, result: 17928 }  # Wraithblade
          - { target: 12276, result: 17929 }  # Websplitter
          - { target: 12277, result: 17930 }  # Fanggyre
          - { target: 12278, result: 17931 }  # Piercefang
          - { target: 12279, result: 17932 }  # Chaosbane
          - { target: 12280, result: 17933 }  # Witchbinder
          - { target: 55289, result: 55420 }  # Trembletube
          - { target: 58440, result: 58476 }  # Maldustar
          - { target: 59337, result: 59468 }  # Anxiae
          - { target: 82289, result: 82420 }  # Tremorfists

    # ── Silrune of Arun (512) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 512
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17568, result: 17936 }  # Afflicter Greaves
          - { target: 17571, result: 17939 }  # Demonkicker Boots
          - { target: 17574, result: 17942 }  # Impchaser Shoes
          - { target: 17566, result: 17934 }  # Bitter Mail
          - { target: 17569, result: 17937 }  # Demonfoe Cuirass
          - { target: 17572, result: 17940 }  # Robe of the Scion
          - { target: 17567, result: 17935 }  # Assailer Gauntlets
          - { target: 17570, result: 17938 }  # Demonsbane Gloves
          - { target: 17573, result: 17941 }  # Demonwitch Sleeves

    # ━━ Cultists' Refuge ━━
    # ── Quoirune of Shara (503) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 503
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17926, result: 12289 }  # Heartblades
          - { target: 17927, result: 12290 }  # Lance of Devotion
          - { target: 17928, result: 12291 }  # Fiendish Claymore
          - { target: 17929, result: 12292 }  # Greataxe of the Forsworn
          - { target: 17930, result: 12293 }  # Avowed Circle
          - { target: 17931, result: 12294 }  # Tailor's Stitcher
          - { target: 17932, result: 12295 }  # Staff of the Warden
          - { target: 17933, result: 12296 }  # Scepter of Infatuation
          - { target: 55420, result: 55291 }  # Arcannon of the Covenant
          - { target: 58476, result: 58442 }  # Heart Shredder
          - { target: 59468, result: 59339 }  # Thologia
          - { target: 82420, result: 82291 }  # Love Taps

    # ── Quoirune of Arun (513) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 513
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17936, result: 17586 }  # Phalanx Greaves
          - { target: 17939, result: 17589 }  # Skirmisher's Boots
          - { target: 17942, result: 17592 }  # Peds of Sikandacar
          - { target: 17934, result: 17584 }  # Lambent Plate of the Champion
          - { target: 17937, result: 17587 }  # Bloodsnarl Overcoat
          - { target: 17940, result: 17590 }  # Sikandacar's Robes
          - { target: 17935, result: 17585 }  # Lambent Fists of the Champion
          - { target: 17938, result: 17588 }  # Skirmisher's Wraps
          - { target: 17941, result: 17591 }  # Sikandacar's Bindings

    # ━━ Labyrinth of Terror ━━
    # ── Archrune of Shara (504) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 504
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 12289, result: 12297 }  # Rip & Snarl
          - { target: 12290, result: 12298 }  # Juggernaut
          - { target: 12291, result: 12299 }  # Anguish
          - { target: 12292, result: 12300 }  # Agonizer
          - { target: 12293, result: 12301 }  # Ebon Spinner
          - { target: 12294, result: 12302 }  # Mistchaser
          - { target: 12295, result: 12303 }  # Mistburner
          - { target: 12296, result: 12304 }  # Lifedrinker
          - { target: 55291, result: 55292 }  # Razergun
          - { target: 58442, result: 58443 }  # Twemol Starblade
          - { target: 59339, result: 59340 }  # Eruxia
          - { target: 82291, result: 82292 }  # Razerfists

    # ── Archrune of Arun (514) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 514
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17586, result: 17595 }  # Greaves of the Depths
          - { target: 17589, result: 17598 }  # Boots of the Raven
          - { target: 17592, result: 17601 }  # Direcrow Slippers
          - { target: 17584, result: 17593 }  # Dreadmist Mail
          - { target: 17587, result: 17596 }  # Cuirass of the Jackdaw
          - { target: 17590, result: 17599 }  # Bloody Quill Robe
          - { target: 17585, result: 17594 }  # Deepmurk Gauntlets
          - { target: 17588, result: 17597 }  # Gloves of the Crow
          - { target: 17591, result: 17600 }  # Mekonari Handwraps

    # ━━ Golden Labyrinth ━━
    # ── Archrune of Shara (504) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 504
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 12297, result: 12793 }  # Ways & Means
          - { target: 12298, result: 12794 }  # Beastblaster
          - { target: 12299, result: 12795 }  # Bruteslayer
          - { target: 12300, result: 12796 }  # Mutilator
          - { target: 12301, result: 12797 }  # Mazespinner
          - { target: 12302, result: 12798 }  # Wayfinder
          - { target: 12303, result: 12799 }  # Labyrinth Lordstaff
          - { target: 12304, result: 12800 }  # Gateopener Scepter
          - { target: 55292, result: 55354 }  # Pathmaker
          - { target: 58443, result: 58464 }  # Rubiblossom
          - { target: 59340, result: 59402 }  # Turntwixer
          - { target: 82292, result: 82354 }  # Mazehammers

    # ── Archrune of Arun (514) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 514
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 17595, result: 18179 }  # Gulabane Greaves
          - { target: 17598, result: 18182 }  # Caiman Kickers
          - { target: 17601, result: 18185 }  # Sihranmade Shoes
          - { target: 17593, result: 18177 }  # Gulaslayer Breastplate
          - { target: 17596, result: 18180 }  # Caimanskin Cuirass
          - { target: 17599, result: 18183 }  # Sihranweave Raiment
          - { target: 17594, result: 18178 }  # Gula Neckwringers
          - { target: 17597, result: 18181 }  # Caimanpelt Gloves
          - { target: 17600, result: 18184 }  # Sihrancloth Sleeves

    # ━━ Akasha's Hideout ━━
    # ── Keyrune of Shara (505) x2 ──
    - $loop:
        range: 0..11
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 505
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 12793, result: 13158 }  # Verdict & Appeal
          - { target: 12794, result: 13159 }  # Lance of Sacrifice
          - { target: 12795, result: 13160 }  # Sword of Cold Reason
          - { target: 12796, result: 13161 }  # Pitiless Axe
          - { target: 12797, result: 13162 }  # Eye of Justice
          - { target: 12798, result: 13163 }  # Executioner's Bow
          - { target: 12799, result: 13164 }  # Staff of Enduring Journeys
          - { target: 12800, result: 13165 }  # Rod of Punishment
          - { target: 55354, result: 55383 }  # Old Judge
          - { target: 58464, result: 58016 }  # Dilastar
          - { target: 59402, result: 59431 }  # Lastglaive
          - { target: 82354, result: 82206 }  # Runechased Powerfists

    # ── Keyrune of Arun (515) x2 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 515
                amount: 2
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 18179, result: 18395 }  # Fringed Azure Greaves
          - { target: 18182, result: 18398 }  # Wanderer's Trackers
          - { target: 18185, result: 18401 }  # Magister's Slippers
          - { target: 18177, result: 18393 }  # Fringed Azure Plate
          - { target: 18180, result: 18396 }  # Wanderer's Jerkin
          - { target: 18183, result: 18399 }  # Magister's Robes
          - { target: 18178, result: 18394 }  # Fringed Azure Gauntlets
          - { target: 18181, result: 18397 }  # Wanderer's Wraps
          - { target: 18184, result: 18400 }  # Magister's Bindings

    # ━━ Suryati's Peak ━━
    # ── Keyrune of Shara (505) x2 + Aeru Rune (520) x1 ──
    - $loop:
        range: 0..10
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 505
                amount: 2
                type: item
              - id: 520
                amount: 1
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 13158, result: 12393 }  # Fassad & Fassouda
          - { target: 13159, result: 12394 }  # Lance of Gabir
          - { target: 13160, result: 12395 }  # Saif-Olek
          - { target: 13161, result: 12396 }  # Asvakar's Cleaver
          - { target: 13162, result: 12397 }  # Lens of Ilderim
          - { target: 13163, result: 12398 }  # Warbow of Djonda
          - { target: 13164, result: 12399 }  # Staff of Kahin
          - { target: 13165, result: 12400 }  # Yaghuth
          - { target: 55383, result: 55304 }  # Skwee Gun
          - { target: 59431, result: 59352 }  # Mosulspear
          - { target: 82206, result: 82304 }  # Fiendish Powerfists

    # ── Keyrune of Arun (515) x1 + Aeru Rune (520) x1 ──
    - $loop:
        range: 0..8
        as: i
      template:
        targetTemplateId: $entries[$i].target
        conditions:
          $loop:
            range: 0..3
            as: j
          template:
            $extends: baseCondition
            targetEnchantStep: $steps[$j].target
            result:
              resultTemplateId: $entries[$i].result
              resultEnchantStep: $steps[$j].result
            materials:
              - id: 515
                amount: 1
                type: item
              - id: 520
                amount: 1
                type: item
          $with:
            steps:
              - { target: 9, result: 0 }
              - { target: 10, result: 3 }
              - { target: 11, result: 6 }
              - { target: 12, result: 9 }
      $with:
        entries:
          - { target: 18395, result: 17694 }  # Nemesis Greaves
          - { target: 18398, result: 17697 }  # Plagueborn Boots
          - { target: 18401, result: 17700 }  # Frostwrath Leggings
          - { target: 18393, result: 17692 }  # Nemesis Plate
          - { target: 18396, result: 17695 }  # Scourge Jerkin
          - { target: 18399, result: 17698 }  # Frostwrath Robes
          - { target: 18394, result: 17693 }  # Nemesis Fists
          - { target: 18397, result: 17696 }  # Pestilence Grips
          - { target: 18400, result: 17699 }  # Frostwrath Sleeves

